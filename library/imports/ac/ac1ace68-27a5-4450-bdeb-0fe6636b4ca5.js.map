{"version":3,"sources":["assets/Scripts/login/Login.js"],"names":["cc","Class","Component","properties","userName","type","EditBox","password","rememberMe","Toggle","lobbyNode","Node","errorLable","Label","loginErrorNode","onLoad","isChecked","onLoginClick","address","K","ServerAddress","ipAddress","ServerAPI","login","data","username","string","active","setTimeout","ServerCom","httpRequest","response","token","randomNumber","Math","floor","random","sys","isBrowser","document","cookie","localStorage","setItem","bind","console","log","error"],"mappings":";;;;;;AACAA,EAAE,CAACC,KAAH,CAAS;AACL,aAASD,EAAE,CAACE,SADP;AAGLC,EAAAA,UAAU,EAAE;AAERC,IAAAA,QAAQ,EAAE;AACN,iBAAS,IADH;AAENC,MAAAA,IAAI,EAAEL,EAAE,CAACM;AAFH,KAFF;AAMRC,IAAAA,QAAQ,EAAE;AACN,iBAAS,IADH;AAENF,MAAAA,IAAI,EAAEL,EAAE,CAACM;AAFH,KANF;AAURE,IAAAA,UAAU,EAAE;AACR,iBAAS,IADD;AAERH,MAAAA,IAAI,EAAEL,EAAE,CAACS;AAFD,KAVJ;AAcRC,IAAAA,SAAS,EAAC;AACN,iBAAS,IADH;AAENL,MAAAA,IAAI,EAAEL,EAAE,CAACW;AAFH,KAdF;AAkBRC,IAAAA,UAAU,EAAC;AACP,iBAAS,IADF;AAEPP,MAAAA,IAAI,EAACL,EAAE,CAACa;AAFD,KAlBH;AAsBRC,IAAAA,cAAc,EAAC;AACX,iBAAS,IADE;AAEXT,MAAAA,IAAI,EAAEL,EAAE,CAACW;AAFE;AAtBP,GAHP;AA+BL;AACAI,EAAAA,MAhCK,oBAgCK;AACN,QAAG,KAAKP,UAAR,EAAmB;AACf,WAAKA,UAAL,CAAgBQ,SAAhB,GAA4B,KAA5B;AACH;AACJ,GApCI;AAsCLC,EAAAA,YAtCK,0BAsCU;AAAA;;AACX,QAAIC,OAAO,GAAGC,CAAC,CAACC,aAAF,CAAgBC,SAAhB,GAA4BF,CAAC,CAACG,SAAF,CAAYC,KAAtD;AACA,QAAIC,IAAI,GAAG;AACPC,MAAAA,QAAQ,EAAE,KAAKrB,QAAL,CAAcsB,MADjB;AAEPnB,MAAAA,QAAQ,EAAE,KAAKA,QAAL,CAAcmB;AAFjB,KAAX;;AAIA,QAAG,KAAKtB,QAAL,CAAcsB,MAAd,IAAwB,EAAxB,IAA8B,KAAKnB,QAAL,CAAcmB,MAAd,IAAwB,EAAzD,EAA4D;AACxD,WAAKd,UAAL,CAAgBc,MAAhB,GAAyB,uCAAzB;AACA,WAAKZ,cAAL,CAAoBa,MAApB,GAA6B,IAA7B;AACAC,MAAAA,UAAU,CAAC,YAAM;AACb,QAAA,KAAI,CAACd,cAAL,CAAoBa,MAApB,GAA6B,KAA7B;AACH,OAFS,EAEP,IAFO,CAAV;AAIA;AACH;;AACDE,IAAAA,SAAS,CAACC,WAAV,CAAsB,MAAtB,EAA8BZ,OAA9B,EAAuCM,IAAvC,EAA6C,UAAUO,QAAV,EAAoB;AAAA;;AAC7D,UAAIA,QAAQ,CAACC,KAAb,EAAoB;AAChB,YAAMC,YAAY,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,EAA3B,IAAiC,CAAtD;;AACA,YAAIpC,EAAE,CAACqC,GAAH,CAAOC,SAAX,EAAsB;AAClBC,UAAAA,QAAQ,CAACC,MAAT,cAA2BT,QAAQ,CAACC,KAApC;AACAO,UAAAA,QAAQ,CAACC,MAAT,gBAA6BP,YAA7B;AACH,SAHD,MAGO;AACHjC,UAAAA,EAAE,CAACqC,GAAH,CAAOI,YAAP,CAAoBC,OAApB,CAA4B,OAA5B,EAAqCX,QAAQ,CAACC,KAA9C;AACAhC,UAAAA,EAAE,CAACqC,GAAH,CAAOI,YAAP,CAAoBC,OAApB,CAA4B,OAA5B,EAAqCT,YAArC;AACH,SARe,CAShB;;;AACAL,QAAAA,UAAU,CAAC,YAAY;AACnB,eAAKlB,SAAL,CAAeiB,MAAf,GAAwB,IAAxB;AACH,SAFU,CAETgB,IAFS,CAEJ,IAFI,CAAD,EAEI,IAFJ,CAAV;AAGH,OAbD,MAcI;AACAC,QAAAA,OAAO,CAACC,GAAR,CAAY,0CAAZ,EAAwDd,QAAxD;AACA,aAAKnB,UAAL,CAAgBc,MAAhB,GAAyBK,QAAQ,CAACe,KAAlC;AACA,aAAKhC,cAAL,CAAoBa,MAApB,GAA6B,IAA7B;AACAC,QAAAA,UAAU,CAAC,YAAM;AACb,UAAA,MAAI,CAACd,cAAL,CAAoBa,MAApB,GAA6B,KAA7B;AACH,SAFS,EAEP,IAFO,CAAV;AAGH;AAEJ,KAxB4C,CAwB3CgB,IAxB2C,CAwBtC,IAxBsC,CAA7C;AA0BH;AA/EI,CAAT","sourceRoot":"/","sourcesContent":["\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n        userName: {\n            default: null,\n            type: cc.EditBox,\n        },\n        password: {\n            default: null,\n            type: cc.EditBox,\n        },\n        rememberMe: {\n            default: null,\n            type: cc.Toggle\n        },\n        lobbyNode:{\n            default: null,\n            type: cc.Node,\n        },\n        errorLable:{\n            default: null,\n            type:cc.Label\n        },\n        loginErrorNode:{\n            default: null,\n            type: cc.Node\n        },\n    \n    },\n    // LIFE-CYCLE CALLBACKS:\n    onLoad () {\n        if(this.rememberMe){\n            this.rememberMe.isChecked = false;\n        }\n    },\n\n    onLoginClick (){\n        var address = K.ServerAddress.ipAddress + K.ServerAPI.login;\n        var data = {\n            username: this.userName.string,\n            password: this.password.string\n        };\n        if(this.userName.string == \"\" || this.password.string == \"\"){\n            this.errorLable.string = \"Username or Password fields are empty\"\n            this.loginErrorNode.active = true;\n            setTimeout(() => {\n                this.loginErrorNode.active = false;\n            }, 2000);\n            \n            return\n        }\n        ServerCom.httpRequest(\"POST\", address, data, function (response) {\n            if (response.token) {\n                const randomNumber = Math.floor(Math.random() * 10) + 1;\n                if (cc.sys.isBrowser) {\n                    document.cookie = `token=${response.token}; path=/;`;\n                    document.cookie = `index = ${randomNumber}`\n                } else {\n                    cc.sys.localStorage.setItem('token', response.token);\n                    cc.sys.localStorage.setItem(\"index\", randomNumber); \n                }\n                // Cookies.set(\"index\", randomNumber);\n                setTimeout(function () {\n                    this.lobbyNode.active = true;\n                }.bind(this), 1000);\n            }\n            else{\n                console.log(\"response of user not found on login page\", response);\n                this.errorLable.string = response.error\n                this.loginErrorNode.active = true;\n                setTimeout(() => {\n                    this.loginErrorNode.active = false;\n                }, 2000);\n            }\n            \n        }.bind(this));\n\n    },\n});"]}