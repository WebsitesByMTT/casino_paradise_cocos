{"version":3,"sources":["assets/Scripts/GamesPrefab.js"],"names":["cc","Class","Component","properties","imageView","Sprite","imageClick","Button","addToFavouirteButton","mywebView","WebView","webviewUrl","lobbyNode","onLoad","setupEventListeners","myScene","find","console","log","getComponent","node","off","onClickItem","addToFavouirte","on","updateItem","data","assetManager","loadRemote","thumbnail","err","texture","error","spriteFrame","SpriteFrame","interactable","url","undefined","openWebView","userData","gameId","_id","type","address","K","ServerAddress","ipAddress","ServerAPI","addtoFav","ServerCom","httpRequest","response","bind"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        imageView: cc.Sprite,\n        imageClick: cc.Button,\n        addToFavouirteButton: cc.Button,\n        mywebView: cc.WebView,\n        webviewUrl: null,\n        lobbyNode: null\n    },\n\n    onLoad() {\n        // console.log(\"onLoad called\");\n        this.setupEventListeners();\n        const myScene = cc.find(\"Canvas\")\n        console.log(myScene, \"finidng\");\n        const lobbyNode = cc.find(\"Canvas/LobbyNode\");\n        if (lobbyNode) {\n            this.lobbyNode = lobbyNode.getComponent(\"Lobby\");\n            if (!this.lobbyNode) {\n                // console.error(\"Lobby component not found on LobbyNode\");\n            }\n        } else {\n            // console.error(\"LobbyNode not found in the scene\");\n        }\n    },\n\n    \n\n    setupEventListeners() {\n        // Remove existing listeners to prevent duplicate event calls\n        this.imageClick.node.off('click', this.onClickItem, this);\n        this.addToFavouirteButton.node.off('click', this.addToFavouirte, this);\n\n        // Add new listeners\n        this.imageClick.node.on('click', this.onClickItem, this);\n        this.addToFavouirteButton.node.on('click', this.addToFavouirte, this);\n    },\n\n    updateItem(data) {\n        cc.assetManager.loadRemote(data.thumbnail, (err, texture) => {\n            if (err) {\n                console.error(err);\n                return;\n            }\n            this.imageView.spriteFrame = new cc.SpriteFrame(texture);\n        });\n\n        // Update click listeners with new data\n        // console.log(\"Updating click listeners for new data\");\n        this.imageClick.node.off('click', this.onClickItem, this);\n        this.addToFavouirteButton.node.off('click', this.addToFavouirte, this);\n        this.imageClick.node.on('click', () => {\n            // console.log(\"imageClick button clicked\");\n            this.onClickItem(data);\n            this.imageClick.node.interactable = false;\n        });\n        this.addToFavouirteButton.node.on('click', () => {\n            this.addToFavouirte(data);\n        });\n    },\n\n    onClickItem(data) {\n        console.log(data);\n        if(data.url == undefined){\n            return;\n        }\n        let webviewUrl = data.url\n        // console.error(\"lobby webview\", this.lobbyNode);\n        // console.log(\"URL to open:\", data.url);\n        \n        \n        console.log(this.lobbyNode);\n        if(this.lobbyNode){\n            this.lobbyNode.openWebView(webviewUrl);\n        }\n    },\n\n    addToFavouirte: function(data) {\n        let userData = {\n            gameId: data._id,\n            type: data.type\n        }\n        let address = K.ServerAddress.ipAddress + K.ServerAPI.addtoFav;\n        ServerCom.httpRequest(\"POST\", address, userData, function(response) {\n            // console.log(\"responseresponse\", response);\n        }.bind(this));\n    },\n});\n"]}